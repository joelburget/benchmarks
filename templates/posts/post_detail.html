{% extends "base.html" %}

{% block title %}{{ object.title }}{% endblock %}

{% block content %}
<h2>{{ object.title }}</h2>
{{ object.body }}

{% load comments %}
{% get_comment_count for object as comment_count %}
<p>Posted by: <a href="/user/{{ object.author }}/">{{ object.author.first_name }} {{ object.author.last_name }}</a>, on {{ object.published }}</p> 
<h2>{{ comment_count }} comment{{ comment_count|pluralize }}</h2>
{% get_comment_list for object as comment_list %}
{% for comment in comment_list %}
  <div id="c{{ comment.id }}">
    <p>{{ comment.submit_date|date:"F j, Y" }} at {{ comment.submit_date|date:"P" }} - <a href="/user/{{ comment.user.username }}">{{ comment.name|escape }}</a></p> 
    <div class="comment">{{ comment.comment|safe|linebreaks }}</div>
  </div>
{% endfor %}
{% if user.is_authenticated %}
<h3>Leave a comment</h3>
{% get_comment_form for object as form %}
    <form action="{% comment_form_target %}" method="POST" enctype="multipart/form-data"> 
{% csrf_token %}
{{ form.comment }} 
{{ form.content_type }} 
{{ form.object_pk }} 
{{ form.timestamp }} 
{{ form.security_hash }} 
{{ upload.as_p }}
<p style="display:none;"> {{ form.honeypot }}</p>
<input type="submit" name="preview" class="submit-preview" value="Preview" />
<input type="submit" value="Add comment" class="submit-post" id="id_submit" />
</form> 
 {% endif %}
{% endblock %}
