{% extends "base.html" %}

{% block title %}Add Post{% endblock %}

{% block jsheadblock %}
<link rel="stylesheet" href="{{ MEDIA_URL }}uniform.default.css" type="text/css" media="screen" charset="utf-8" />
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script type="text/javascript">
// Determines the type of form, based on what
// is available (Flash, JS, None)
/*var swfupload;

function upload_form()
{
if (FlashDetect.installed && FlashDetect.versionAtLeast(9, 0, 28))
  {
    // Flash 9.0.24 or above
    swfupload = new SWFUpload({
      debug : false,

      upload_url : '/upload',
      flash_url : '{{ MEDIA_URL }}swfupload/swfupload/Flash/swfupload.swf',

      button_placeholder_id : 'filebay',
      button_width : '40',
      button_height : '16',
      button_cursor : SWFUpload.CURSOR.HAND,
      button_text : 'Click',

      file_dialog_complete_handler : function () { this.startUpload(); },
      upload_complete_handler : function () { this.startUpload(); },
    });
  }
  else
  {
    // Javascript
    $('#filebay').html('<input type="file" id="files" />');
    $('#files').MultiFile({'list':'#filesList'});
  }
}


// Loaded after document is done loading
$(document).ready(upload_form);
*/
</script>
<script src="{{ MEDIA_URL }}codemirror/js/codemirror.js" type="text/javascript"></script>
<script src="{{ MEDIA_URL }}codemirror/js/mirrorframe.js" type="text/javascript"></script>
<script type="text/javascript">
$(document).ready(function() {
   var editor = new CodeMirror.fromTextArea('id_body', {
     parserfile: "parsexml.js",
     path: "{{ MEDIA_URL }}codemirror/js/",
     stylesheet: "{{ MEDIA_URL }}codemirror/css/xmlcolors.css",
     height: "400px",
     width: "500px"
   });
});
</script>
{% endblock %}

{% block content %}
<form action="." method="post" enctype="multipart/form-data">
  {% csrf_token %}
  <ol>
    <li>
      {{ form.title.label_tag }} {{ form.title }}
    </li>
    <li>
    {{ form.body.label_tag }}
    <br />
    {{ form.body }}
    </li>
    <li>
    {{ form.category.label_tag }} {{ form.category }}
    </li>
    <li>
      <div id="parent_stuff">{{ form.parent.label_tag }}<span id="optional"> (Optional)</span> {{ form.parent }}</div>
    </li>

    <li>
      <label for="file1">File</label><input class="realupload" type="file" name="file1" id="file1" />
    </li>
    <li>
      <label for="file2">File</label><input class="realupload" type="file" name="file2" id="file2" />
    </li>
    <li>
      <label for="file3">File</label><input class="realupload" type="file" name="file3" id="file3" />
    </li>
    <li>
      <input class="button" type="submit" value="Submit" />
    </li>
</ol>
</form>
{% endblock %}

{% block jsblock %}
<script type="text/javascript" src="{{ MEDIA_URL }}jquery.MultiFile.pack.js"></script>
<!--script type="text/javascript" src="{{ MEDIA_URL }}flash_detect_min.js"></script-->
<!--script type="text/javascript" src="{{ MEDIA_URL }}swfupload/swfupload/swfupload.js"></script-->
<!--script type="text/javascript" src="{{ MEDIA_URL }}swfupload/swfupload/plugins/swupload.cookies.js"></script-->
<script src="{{ MEDIA_URL }}jquery.uniform.js" type="text/javascript"></script>
<script>
$("#parent_stuff").hide();
$("#optional").hide();
$("#id_category").change(function() {
  var val = $(this).val();
  if (val === "O") {
    $("#optional").fadeIn();
  }
  else {
    $("#optional").fadeOut();
  }
  if ((val !== "") && (val !== "P")) {
    $("#parent_stuff").slideDown();
  }
  else {
    $("#parent_stuff").slideUp();
  }
});
$("select, input:checkbox, input:radio, input:file").uniform();
</script>
{% endblock %}
