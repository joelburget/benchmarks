{% extends "base.html" %}

{% block title %}Add Post{% endblock %}

{% block cssblock %}
<link rel="stylesheet" href="{{ MEDIA_URL }}css/uniform.default.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="{{ MEDIA_URL }}css/TextboxList.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="{{ MEDIA_URL }}css/TextboxList.Autocomplete.css" type="text/css" media="screen" charset="utf-8" />
{% endblock %}

{% block content %}
<form action="." method="post" enctype="multipart/form-data">
  {% csrf_token %}
  <ol>
    <li>
      {{ form.title.label_tag }} {{ form.title }}
    </li>
    <li>
    <label for="id_body">Body (We accept common HTML tags, such as <b>&lt;b&gt;</b>, <i>&lt;i&gt;</i>, and <code>&lt;code&gt;</code>):</label>
    <br />
    {{ form.body }}
    </li>
    <li>
    {{ form.category.label_tag }} {{ form.category }}
    </li>
    <li>
      <div id="parent_stuff">{{ form.parent.label_tag }}<span id="optional"> (Optional)</span> {{ form.parent }}</div>
    </li>
    <li>
      <label for="file1">File</label><input class="realupload" type="file" name="file1" id="file1" />
    </li>
    <li>
      <label for="file2">File</label><input class="realupload" type="file" name="file2" id="file2" />
    </li>
    <li>
      <label for="file3">File</label><input class="realupload" type="file" name="file3" id="file3" />
    </li>
    <li>
      <input class="button" type="submit" value="Submit" />
    </li>
  <div id="filelist"></div>
</ol>
</form>
{% endblock %}

{% block jsblock %}
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script type="text/javascript" src="{{ MEDIA_URL }}js/TextboxList.js"></script>
<script type="text/javascript" src="{{ MEDIA_URL }}js/TextboxList.Autocomplete.js"></script>
<script type="text/javascript" src="{{ MEDIA_URL }}js/GrowingInput.js"></script>
<script type="text/javascript" src="http://ajax.microsoft.com/ajax/jquery.validate/1.7/jquery.validate.min.js"></script>
<script type="text/javascript" src="{{ MEDIA_URL }}js/jquery.MultiFile.pack.js"></script>
<!--<script type="text/javascript" src="{{ MEDIA_URL }}flash_detect_min.js"></script>
<script type="text/javascript" src="{{ MEDIA_URL }}swfupload/swfupload/swfupload.js"></script>
<script type="text/javascript" src="{{ MEDIA_URL }}swfupload/swfupload/plugins/swupload.cookies.js"></script>-->
<script src="{{ MEDIA_URL }}js/jquery.uniform.js" type="text/javascript"></script>
<script src="{{ MEDIA_URL }}codemirror/js/codemirror.js" type="text/javascript"></script>
<script src="{{ MEDIA_URL }}codemirror/js/mirrorframe.js" type="text/javascript"></script>
<script>
(function($){
  $("#parent_stuff").hide();
  $("#optional").hide();
  $("#id_category").change(function(){
    var val = $(this).val();
    if (val === "O") {
      $("#optional").fadeIn();
    }
    else {
      $("#optional").fadeOut();
    }
    if ((val !== "") && (val !== "P")){
      $("#parent_stuff").slideDown();
    }
    else {
      $("#parent_stuff").slideUp();
    }
  });
  $("input:checkbox, input:radio, input:file").uniform();
     $('form').validate();
     var editor = new CodeMirror.fromTextArea('id_body', {
       parserfile: "parsexml.js",
       path: "{{ MEDIA_URL }}codemirror/js/",
       stylesheet: "{{ MEDIA_URL }}codemirror/css/xmlcolors.css",
       height: "400px",
       width: "500px"
  });
  var t = new $.TextboxList('#id_parent', {max: 1, plugins: {autocomplete: {}}});
  var autocomplete = t.plugins['autocomplete'];
  autocomplete.setValues([
  {% for object in object_list %}
  [{{ object.id }}, '{{ object.author.first_name }} {{ object.author.last_name }} - {{ object.title }}', '{{ object.title }}'],
  {% endfor %}
  ]);
  $('.textboxlist-autocomplete').css({'width': '541px', 'margin-left': '50px'});
})(jQuery);
</script>
{% endblock %}
